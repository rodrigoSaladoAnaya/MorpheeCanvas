<html>
	<head>
		<script type="text/javascript" src="jquery-1.9.0.js">
		</script>
		<script type="text/javascript">
			var Datos = {
				contextoCanvas: null,
				pageX: 0,
				pageY: 0,
				getInitialPosX: function(){ 
					return this.pageX -  $("#area-dibujo").offset().left
				},
				getInitialPosY: function(){ 
					return this.pageY -  $("#area-dibujo").offset().top 
				},
				comportamientoDeNuevaLinea : function(){
					$("#nueva-linea").click(function(){ 
						Datos.contextoCanvas.beginPath();
						Datos.imprimeConsolaDeSalida();
					});
				},
				comportamientoDelAreaDeDibujo: function(){
					$("#area-dibujo").mousemove(function(e){
						Datos.pageX = e.pageX;
						Datos.pageY = e.pageY;
						Datos.imprimeConsolaDeSalida();
					}).click(function(){
						var x = Datos.getInitialPosX();
						var y = Datos.getInitialPosY();
						Datos.contextoCanvas.lineTo(x, y);
						Datos.contextoCanvas.stroke();
					}).mouseout(function(){
						Datos.muestraMensajeDeEspera();
					});
				},
				ponePropiedadesDelAreaDeDibujo: function(){
					$("#area-dibujo")
						.attr("width", "200")
						.attr("height", "200");
					$("#area-dibujo").css("border","1px solid");
				},
				muestraMensajeDeEspera: function(){
					$("#console-de-salida").html("> Awaiting a position...");
				},
				imprimeConsolaDeSalida: function(pageX, pageY){
					var salida = "> x: " + Datos.pageX + ", y: " + Datos.pageY + "<br/>";
					$("#console-de-salida").html(salida);	
				},
				iniciaAreaDeDibujo: function(){
					Datos.contextoCanvas = $("#area-dibujo")[0].getContext("2d");
					Datos.contextoCanvas.beginPath();
				}
			}

			$(document).ready(function(){
				Datos.ponePropiedadesDelAreaDeDibujo();
				Datos.muestraMensajeDeEspera();
				Datos.iniciaAreaDeDibujo();
				Datos.comportamientoDelAreaDeDibujo();
				Datos.comportamientoDeNuevaLinea();
			});
		</script>
	</head>
	<body>
		<canvas id="area-dibujo" border=1px></canvas>
		<button type="button" id="nueva-linea">New line</button>
		<div id="console-de-salida" />
	</body>
</html>